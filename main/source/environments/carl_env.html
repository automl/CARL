<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>The CARL Environment &#8212; CARL Documentation 1.0.0 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ac9c05f7c49ca1e1f876c6e36360ea26.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=2eb4fb78" />
    
  <link rel="preload" as="script" href="../../_static/js/index.9ea38e314b9e6d9dab77.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=367f7090"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Environment Families" href="environment_families/index.html" />
    <link rel="prev" title="Environments" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
  <a class="navbar-brand" href="../../index.html">
  <!-- <p class="title">CARL Documentation</p> -->
  </a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/automl/automl_sphinx_theme" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/automl_org?lang=de" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <div class="dropdown mt-1">
    <button type="button" class="btn btn-secondary btn-md navbar-btn dropdown-toggle" id="dLabelMore"
        data-toggle="dropdown">
        v1.0.0
        <span class="caret"></span>
    </button>
    <div class="dropdown-menu list-group-flush py-0" aria-labelledby="dLabelMore">
        <a class="list-group-item list-group-item-action" href="#">v1.0.0 (stable)</a>
    </div>
</div>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search align-items-center" action="../../search.html" method="get" style="width: 100%;">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control btn btn-md" name="q" id="search-input"
    placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off">
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><h4 class="mt-0 mb-0"><a href="../../index.html">CARL Documentation</a></h4>
<div class="mb-3">v1.0.0</div><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../getting_started/index.html">
   Getting Started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../getting_started/installation.html">
     Installing CARL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../getting_started/quickstart.html">
     Quickstart
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Environments
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     The CARL Environment
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="environment_families/index.html">
     Environment Families
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="environment_families/classic_control.html">
       CARL Classic Control Environments
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="environment_families/box2d.html">
       CARL Box 2D Environments
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="environment_families/brax.html">
       CARL Brax Environments
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="environment_families/dmc.html">
       CARL DMC Environments
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="environment_families/toad_gan.html">
       CARL Mario Environment
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="environment_families/rna.html">
       CARL RNA Design Environment
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="benchmark_properties.html">
     Benchmark Properties
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="carlify.html">
     CARLify your Environment
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api/index.html">
   API Reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cite.html">
   Citing CARL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../license.html">
   License
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   References
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="the-carl-environment">
<h1>The CARL Environment<a class="headerlink" href="#the-carl-environment" title="Permalink to this heading">¶</a></h1>
<p>CARL extends the standard <a class="reference external" href="https://gymnasium.farama.org/content/basic_usage/">gymnasium interface</a>  with context.
This context changes the environment’s transition dynamics and reward
function, creating a greater challenge for the agent.
During training we therefore can encounter different contexts and train for generalization.
We exemplarily show how Brax’ Fetch is extended and embedded by CARL. Different
instantiations can be achieved by setting the context features to different values.</p>
<p>Here we give a brief overview of the available options on how to create
and work with contexts.</p>
<p>A context takes the form of a dictionary with a key-value pair for each
context feature. An example is the default context for the CARLAnt environment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Ant_defaults</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;joint_stiffness&quot;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
    <span class="s2">&quot;gravity&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.8</span><span class="p">,</span>
    <span class="s2">&quot;friction&quot;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>
    <span class="s2">&quot;angular_damping&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="s2">&quot;actuator_strength&quot;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
    <span class="s2">&quot;joint_angular_damping&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span>
    <span class="s2">&quot;torso_mass&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The context set used for training is comprised of at least one context.
It is also a dictionary with keys that should identify the context in a
meaningful way, e.g. an id. An example of a simple instance set for
CARLCartPole would be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">src.envs</span> <span class="kn">import</span> <span class="n">CARLCartPoleEnv_defaults</span> <span class="k">as</span> <span class="n">default</span>
<span class="n">longer_pole</span> <span class="o">=</span> <span class="n">default</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">longer_pole</span><span class="p">[</span><span class="s2">&quot;pole_length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default</span><span class="p">[</span><span class="s2">&quot;pole_length&quot;</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span>
<span class="n">contexts</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">default</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">longer_pole</span><span class="p">}</span>
</pre></div>
</div>
<p>This context set can then be used to create the environment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">src.envs</span> <span class="kn">import</span> <span class="n">CARLCartPoleEnv</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CARLCartPoleEnv</span><span class="p">(</span><span class="n">contexts</span><span class="o">=</span><span class="n">contexts</span><span class="p">)</span>
</pre></div>
</div>
<p>Per default, the context will be changed each episode in a round robin
fashion.</p>
<p>The user can choose if and how the context is provided to the agent.
If the context should be hidden completely, instantiate the environment
with the ‘hide_context’ option:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">src.envs</span> <span class="kn">import</span> <span class="n">CARLCartPoleEnv</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CARLCartPoleEnv</span><span class="p">(</span><span class="n">contexts</span><span class="o">=</span><span class="n">contexts</span><span class="p">,</span> <span class="n">hide_context</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, the context is visible and concatenated onto the state information
with no separation between state and context features. They can be
<em>provided separately</em>, though, using dict observations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">src.envs</span> <span class="kn">import</span> <span class="n">CARLCartPoleEnv</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CARLCartPoleEnv</span><span class="p">(</span><span class="n">contexts</span><span class="o">=</span><span class="n">contexts</span><span class="p">,</span> <span class="n">hide_context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dict_observation_space</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Furthermore, users can choose to provide the full context information (default)
or only a <em>subset</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">src.envs</span> <span class="kn">import</span> <span class="n">CARLCartPoleEnv</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CARLCartPoleEnv</span><span class="p">(</span><span class="n">contexts</span><span class="o">=</span><span class="n">contexts</span><span class="p">,</span> <span class="n">state_context_features</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gravity&quot;</span><span class="p">,</span> <span class="s2">&quot;pole_length&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Context features can also be normalized or augmented with noise to either
make learning easier or more difficult.
In addition, only the context features <em>changing across the contexts</em> provided can be appended to the state like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">src.envs</span> <span class="kn">import</span> <span class="n">CARLCartPoleEnv</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">CARLCartPoleEnv</span><span class="p">(</span><span class="n">contexts</span><span class="o">=</span><span class="n">contexts</span><span class="p">,</span> <span class="n">state_context_features</span><span class="o">=</span><span class="s2">&quot;changing_context_features&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Environments</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="environment_families/index.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Environment Families</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.9ea38e314b9e6d9dab77.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 
    Copyright 2023, AutoML.org Freiburg-Hannover
.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a>
7.1.2. Template is modified version of <a
href="https://pydata-sphinx-theme.readthedocs.io">PyData Sphinx Theme</a>. <br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>