defaults:
  - slurm/gpu
  - _self_
  - algorithm/sac
  - override hydra/launcher: submitit_slurm
  - override hydra/job_logging: colorlog
  - override hydra/hydra_logging: colorlog

experiment: benchmarking
wandb:
  id: null
  entity: tnt
  debug: false
  group: ???  # set in context_visibility
  job_type: train
  tags: []
  notes: null
  project: carl-tmlr

carl:
  hide_context: false
  dict_observation_space: false
  scale_context_features: "no" # by_mean, by_default
  state_context_features: null
  add_gaussian_noise_to_context: false
  gaussian_noise_std_percentage: 0.15

algorithm: sac
debug: false
seed: 0
group: null

env: CARLPendulumEnv
max_num_frames: 100000
n_step: 5
gamma: 0.9
alpha: 0.2
batch_size: 128
learning_rate: 0.001
q_targ_tau: 0.001
warmup_num_frames: 5000
pi_warmup_num_frames: 7500
pi_update_freq: 4


replay_capacity: 100000
render_freq: 10000
eval_freq: 10000
eval_episodes: 100
eval_on_train_context: true
contexts_train_path: null  # priority over context_sampler
contexts_eval_path: null
kirk_evaluation_protocol:
  follow: false

zero_context: false # set context to zero
state_context: false # set context to state feature subset
pi_context: true
q_context: true
context_state_indices: null

context_branch:
  width: 32

context_sampler:
  env_name: ${env}
  context_feature_names: []
  seed: ${seed}
  n_samples: 1000
  sigma_rel: 0.1  # 0.1, 0.25, 0.5

encoder:
  weights: null
  model: ContextAE

output_dir: ./tmp
hydra:
  run:
    dir: ${output_dir}/${now:%Y-%m-%d}/${now:%H-%M-%S}
  sweep:
    dir: ${output_dir}/${now:%Y-%m-%d}/${now:%H-%M-%S}
  launcher:
    setup:
      - export XLA_PYTHON_CLIENT_PREALLOCATE=false
